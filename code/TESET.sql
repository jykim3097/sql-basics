SELECT JOB_ID, 
       COUNT(*) AS 직무별사원수, 
       SUM(SALARY) AS 직무별급여합, 
       TRUNC(AVG(SALARY)) AS 직무별급여평균
FROM EMPLOYEES
GROUP BY JOB_ID;

CREATE SEQUENCE BOARD_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 1000000
    NOCACHE;

CREATE TABLE board (
    BNO NUMBER(2)           PRIMARY KEY,
    WRITER VARCHAR2(10)     REFERENCES USERS(ID),
    TITLE VARCHAR2(30),
    CONTENT VARCHAR(300),
    REGDATE DATE            DEFAULT SYSDATE,
    UPDATEDATE DATE         DEFAULT SYSDATE
);

DROP TABLE BOARD;

SELECT * FROM users;
INSERT INTO USERS VALUES ('kkk123', '*****', '홍길동', '서울');
INSERT INTO USERS VALUES ('aaa', '****', '홍길자', '경기');
INSERT INTO USERS VALUES ('bbb', '*****', '이순신', '서울');
INSERT INTO USERS VALUES ('ccc', '****', '강감찬', '서울');
INSERT INTO USERS VALUES ('ddd', '******', '박찬호', '부산');

INSERT INTO BOARD VALUES (1, 'kkk123', '첫글', '~~','2020-04-11','2020-04-11');
INSERT INTO BOARD VALUES (2, 'aaa', '이거처음이야', '~~','2020-04-11','2020-04-11');
INSERT INTO BOARD VALUES (3, 'kkk123', '이런거본적있어?', '~~','2020-04-12','2020-04-13');
INSERT INTO BOARD VALUES (4, 'bbb', '질문이요', '~~','2020-04-13','2020-04-13');
INSERT INTO BOARD VALUES (5, 'ccc', '우와~', '~~','2020-04-15','2020-04-15');

INSERT INTO BOARD VALUES (6, 'bbb', '질문이요2', '~~','2020-04-13','2020-04-13');
INSERT INTO BOARD VALUES (7, 'bbb', '질문이요3', '~~','2020-04-13','2020-04-13');

INSERT INTO BOARD VALUES (8, 'aaa', '안녕', '~~','2020-04-16','2020-04-16');
INSERT INTO BOARD VALUES (9, 'ddd', '질문이요4', '~~','2020-04-17','2020-04-17');
INSERT INTO BOARD VALUES (10, 'ccc', '우와~@!', '~~','2020-04-18','2020-04-18');

SELECT * FROM board;

UPDATE BOARD SET TITLE = '이거처음아니야' WHERE BNO = 2;
UPDATE BOARD SET CONTENT = 'X' WHERE BNO = 2;
UPDATE BOARD SET UPDATEDATE = SYSDATE WHERE BNO = 2;

SELECT * 
FROM BOARD
WHERE TITLE LIKE '%질문%'
ORDER BY BNO ASC;

CREATE TABLE USERS (
    ID VARCHAR2(10)     PRIMARY KEY,
    PW VARCHAR2(10),
    NAME VARCHAR2(10),
    ADDRESS VARCHAR2(10)
);

SELECT * FROM USERS;

INSERT INTO USERS VALUES('STAR', '*****', '벅스', '서울');

INSERT INTO 댓글 VALUES (5,1,'ccc','~~', SYSDATE);

select * from board;

SELECT *
FROM(SELECT ROWNUM AS RN,A.*
     FROM (SELECT *
           FROM BOARD
           ORDER BY UPDATEDATE DESC) A)
WHERE RN >=1 AND RN <= 10;

DESC BOARD;

CREATE TABLE 댓글 (
    RNO NUMBER(2) PRIMARY KEY,
    BNO NUMBER(2) REFERENCES BOARD(BNO),
    WRITER VARCHAR2(10),
    CONTENT VARCHAR2(200),
    REGDATE DATE DEFAULT SYSDATE
);

SELECT * FROM 댓글;

INSERT INTO 댓글 VALUES (1,1, 'aaa', '~~', '2020-04-13');
INSERT INTO 댓글 VALUES (2,1, 'aaa', '~~', to_date('2020-04-14'));
INSERT INTO 댓글 VALUES (3,2, 'ccc', '~~', to_date('2020-04-15'));
INSERT INTO 댓글 VALUES (4,5, 'aaa', '~~', to_date('2020-04-15'));


select *
from board b left outer join 댓글 d on b.bno = d.bno
order by b.bno;

SELECT B.BNO, B.WRITER, B.TITLE, B.CONTENT, B.REGDATE, B.UPDATEDATE, COUNT(*)
FROM BOARD B LEFT OUTER JOIN 댓글 D ON B.BNO = D.BNO
GROUP BY B.BNO, B.WRITER, B.TITLE, B.CONTENT, B.REGDATE, B.UPDATEDATE
ORDER BY B.BNO;

SELECT B.BNO, 
       B.WRITER, 
       B.TITLE, 
       B.CONTENT, 
       B.REGDATE, 
       B.UPDATEDATE,
       (SELECT COUNT(*)
        FROM 댓글 D
        WHERE B.BNO = D.BNO) AS 댓글수
FROM BOARD B
GROUP BY B.BNO, B.WRITER, B.TITLE, B.CONTENT, B.REGDATE, B.UPDATEDATE
ORDER BY B.BNO;

CREATE TABLE MEMBERS (
    NO NUMBER(2),
    ID VARCHAR2(30)             PRIMARY KEY,
    PW VARCHAR2(30),
    NAME VARCHAR2(30),
    ADDRESS VARCHAR2(30),
    PHONE VARCHAR2(30),
    MEMBER_TYPE VARCHAR2(30),
    USE_YN VARCHAR2(1) CHECK(USE_YN IN ('Y','N')),
    REGDATE DATE DEFAULT SYSDATE
);

DROP TABLE MEMBERS;


INSERT INTO MEMBERS VALUES(1,'com01','*******', '홍길동','서울시','01012341234','관리자', 'Y', '2019-10-10');
INSERT INTO MEMBERS VALUES(2,'com02','*******', '홍길자','서울시','01011111111','관리자', 'Y', '2019-09-05');
INSERT INTO MEMBERS VALUES(3,'kkk123','****', '이순자','부산시','01023234567','일반회원', 'Y', '2020-05-04');

select * from members;

CREATE INDEX MEMBERS_PHONE_IDX
ON MEMBERS(PHONE);

CREATE VIEW MEMBERS_VIEW
AS SELECT NAME, ADDRESS, PHONE, MEMBER_TYPE
   FROM MEMBERS;
   
DESC MEMBERS_VIEW;

SELECT * FROM MEMBERS_VIEW;

--CREATE USER USER1 IDENTIFIED BY USER1;
CREATE USER COM03 IDENTIFIED BY COM03;