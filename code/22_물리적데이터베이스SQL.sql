
/* Drop Triggers */

DROP TRIGGER TRI_BOARD_BNO;
DROP TRIGGER TRI_LECTURE_LNO;
DROP TRIGGER TRI_REPLY_RNO;



/* Drop Tables */

DROP TABLE ADMIN_LIST CASCADE CONSTRAINTS;
DROP TABLE REPLY CASCADE CONSTRAINTS;
DROP TABLE BOARD CASCADE CONSTRAINTS;
DROP TABLE LEC_ORDER CASCADE CONSTRAINTS;
DROP TABLE LECTURE CASCADE CONSTRAINTS;
DROP TABLE USERS CASCADE CONSTRAINTS;



/* Drop Sequences */

DROP SEQUENCE SEQ_BOARD_BNO;
DROP SEQUENCE SEQ_LECTURE_LNO;
DROP SEQUENCE SEQ_REPLY_RNO;




/* Create Sequences */

CREATE SEQUENCE SEQ_BOARD_BNO INCREMENT BY 1 START WITH 1;
CREATE SEQUENCE SEQ_LECTURE_LNO INCREMENT BY 1 START WITH 1;
CREATE SEQUENCE SEQ_REPLY_RNO INCREMENT BY 1 START WITH 1;



/* Create Tables */

CREATE TABLE ADMIN_LIST
(
	ID varchar2(30) NOT NULL,
	REG_DATE date DEFAULT SYSDATE,
	PRIMARY KEY (ID)
);


CREATE TABLE BOARD
(
	BNO number(10) NOT NULL,
	WRITER varchar2(30),
	TITLE varchar2(30),
	CONTENT varchar2(2000),
	PRIMARY KEY (BNO)
);


CREATE TABLE LECTURE
(
	LNO number(10) NOT NULL,
	TEACHER varchar2(30) NOT NULL,
	LEC_LIST varchar2(30),
	PRIMARY KEY (LNO)
);


CREATE TABLE LEC_ORDER
(
	ID varchar2(30) NOT NULL,
	LNO number(10) NOT NULL,
	ORDER_DATE date,
	PRIMARY KEY (ID, LNO)
);


CREATE TABLE REPLY
(
	RNO number(10) NOT NULL,
	WRITER varchar2(30) NOT NULL,
	CONTENT varchar2(2000),
	BNO number(10) NOT NULL,
	PRIMARY KEY (RNO)
);


CREATE TABLE USERS
(
	ID varchar2(30) NOT NULL,
	NAME varchar2(30) NOT NULL,
	REG_DATE date,
	PHONE_NUM varchar2(15),
	PRIMARY KEY (ID)
);



/* Create Foreign Keys */

ALTER TABLE REPLY
	ADD FOREIGN KEY (BNO)
	REFERENCES BOARD (BNO)
;


ALTER TABLE LEC_ORDER
	ADD FOREIGN KEY (LNO)
	REFERENCES LECTURE (LNO)
;


ALTER TABLE ADMIN_LIST
	ADD FOREIGN KEY (ID)
	REFERENCES USERS (ID)
;


ALTER TABLE BOARD
	ADD FOREIGN KEY (WRITER)
	REFERENCES USERS (ID)
;


ALTER TABLE LEC_ORDER
	ADD FOREIGN KEY (ID)
	REFERENCES USERS (ID)
;


ALTER TABLE REPLY
	ADD FOREIGN KEY (WRITER)
	REFERENCES USERS (ID)
;



/* Create Triggers */

CREATE OR REPLACE TRIGGER TRI_BOARD_BNO BEFORE INSERT ON BOARD
FOR EACH ROW
BEGIN
	SELECT SEQ_BOARD_BNO.nextval
	INTO :new.BNO
	FROM dual;
END;

/

CREATE OR REPLACE TRIGGER TRI_LECTURE_LNO BEFORE INSERT ON LECTURE
FOR EACH ROW
BEGIN
	SELECT SEQ_LECTURE_LNO.nextval
	INTO :new.LNO
	FROM dual;
END;

/

CREATE OR REPLACE TRIGGER TRI_REPLY_RNO BEFORE INSERT ON REPLY
FOR EACH ROW
BEGIN
	SELECT SEQ_REPLY_RNO.nextval
	INTO :new.RNO
	FROM dual;
END;

/




